<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MEDITRACK LIMITED Attendance List</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- ✅ Makes it mobile-friendly -->
  <!-- Latest EmailJS SDK v4 -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    (function(){
      emailjs.init("Wfz_vJ2NRT4YzMoJV"); // ✅ Your EmailJS Public Key
    })();
  </script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7fa;
      margin: 0;
      padding: 1em;
    }
    h1 { text-align: center; color: #333; font-size: 1.5em; }
    #date-today { text-align: right; margin-bottom: 10px; font-size: 1em; }

    /* ✅ Make table scrollable on small screens */
    .table-container { 
      width: 100%; 
      overflow-x: auto; 
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      margin: 1em auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      min-width: 700px; /* prevent squashing too much */
    }
    th, td { padding: 0.6em; text-align: center; border-bottom: 1px solid #ececec; }
    th { background: #4f8ef7; color: #fff; }
    tr:last-child td { border-bottom: none; }

    input[type="time"], input[type="date"], input[type="text"] {
      width: 100%;
      max-width: 130px;
      padding: 0.3em;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    select.status, select.shift {
      padding: 0.4em;
      border-radius: 4px;
      border: 1px solid #ccc;
      width: 100%;
      max-width: 130px;
    }

    .status-message { font-weight: bold; padding: 0.4em; border-radius: 4px; margin-top: 3px; }
    .status-present { background: #e6ffe6; color: #1e7e34; }
    .status-absent { background: #ffe6e6; color: #c82333; }
    .status-on-leave { background: #e6f7ff; color: #005cbf; }
    .status-late, .status-late-break { background: #fffbe6; color: #d35400; }
    .status-multi-late { background: #ffe6e6; color: #b8860b; }

    button {
      display: inline-block;
      margin: 0.5em;
      padding: 0.6em 1.5em;
      background: #4f8ef7;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1em;
      cursor: pointer;
    }
    button:hover { background: #3563b7; }

    #add-staff-section, #search-section, #summary-section {
      max-width: 600px;
      margin: 0 auto 1em auto;
      background: #fff;
      padding: 1em;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      text-align: center;
    }

    #summary-output { margin-top: 1em; font-size: 0.95em; }

    /* ✅ Mobile adjustments */
    @media (max-width: 768px) {
      body { padding: 0.5em; }
      h1 { font-size: 1.2em; }
      #date-today { font-size: 0.9em; text-align: center; }

      table { font-size: 0.85em; }
      input, select, button { font-size: 0.9em; }
      button { width: 100%; margin: 0.5em 0; }
    }
  </style>
</head>
<body>
  <h1>MEDITRACK LIMITED Attendance List</h1>
  <div id="date-today"></div>

  <!-- ✅ Scrollable table container -->
  <div class="table-container">
    <table id="attendance-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Shift</th>
          <th>Clock In</th>
          <th>Break Out</th>
          <th>Break In</th>
          <th>Clock Out</th>
          <th>Status</th>
          <th>Remark</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- Staff rows go here -->
      </tbody>
    </table>
  </div>

  <div id="add-staff-section">
    <h3>Add Staff</h3>
    <input type="text" id="new-staff-name" placeholder="Enter staff name">
    <button onclick="addStaff()">Add</button>
  </div>

  <div id="search-section">
    <h3>Search Staff</h3>
    <input type="text" id="search-input" placeholder="Search by name" onkeyup="searchStaff()">
  </div>

  <div id="summary-section">
    <h3>Summary</h3>
    <button onclick="generateSummary()">Generate Summary</button>
    <div id="summary-output"></div>
  </div>

  <script>
    // ✅ Display today's date
    document.getElementById("date-today").innerText = new Date().toDateString();

    function addStaff() {
      const nameInput = document.getElementById("new-staff-name");
      const name = nameInput.value.trim();
      if (!name) return;

      const table = document.getElementById("attendance-table").getElementsByTagName("tbody")[0];
      const row = table.insertRow();

      row.innerHTML = `
        <td>${name}</td>
        <td>
          <select class="shift">
            <option value="Morning">Morning</option>
            <option value="Afternoon">Afternoon</option>
            <option value="Night">Night</option>
          </select>
        </td>
        <td><input type="time"></td>
        <td><input type="time"></td>
        <td><input type="time"></td>
        <td><input type="time"></td>
        <td>
          <select class="status" onchange="updateStatus(this)">
            <option value="Present">Present</option>
            <option value="Absent">Absent</option>
            <option value="On Leave">On Leave</option>
            <option value="Late">Late</option>
          </select>
          <div class="status-message status-present">Present</div>
        </td>
        <td><input type="text" placeholder="Remark"></td>
        <td><button onclick="deleteStaff(this)">Delete</button></td>
      `;

      nameInput.value = "";
    }

    function deleteStaff(btn) {
      const row = btn.closest("tr");
      row.remove();
    }

    function updateStatus(select) {
      const messageDiv = select.nextElementSibling;
      const value = select.value;
      messageDiv.className = "status-message";
      switch(value) {
        case "Present": messageDiv.classList.add("status-present"); break;
        case "Absent": messageDiv.classList.add("status-absent"); break;
        case "On Leave": messageDiv.classList.add("status-on-leave"); break;
        case "Late": messageDiv.classList.add("status-late"); break;
      }
      messageDiv.textContent = value;
    }

    function searchStaff() {
      const input = document.getElementById("search-input").value.toLowerCase();
      const rows = document.querySelectorAll("#attendance-table tbody tr");
      rows.forEach(row => {
        const nameCell = row.querySelector("td:first-child");
        if (nameCell && nameCell.textContent.toLowerCase().includes(input)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
    }

    function generateSummary() {
      const rows = document.querySelectorAll("#attendance-table tbody tr");
      let summary = "";
      rows.forEach(row => {
        const name = row.querySelector("td:first-child").textContent;
        const shift = row.querySelector(".shift").value;
        const status = row.querySelector(".status").value;
        summary += `${name} - ${shift} - ${status}\n`;
      });
      document.getElementById("summary-output").innerText = summary;

      // ✅ Send summary via EmailJS
      emailjs.send("service_c57bg7g", "template_mlh2ahf", {
        to_email: "dejalizzy25@gmail.com",
        date: new Date().toDateString(),
        summary: summary
      }).then(() => {
        alert("Summary sent successfully!");
      }).catch(err => {
        alert("Error sending summary: " + err);
      });
    }
  </script>
</body>
</html>
